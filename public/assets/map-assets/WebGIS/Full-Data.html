<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>Geospasial | WebGIS</title>
    <meta content="" name="description" />
    <meta content="" name="keywords" />

    <!-- Favicons -->
    <link href="/assets/img/favicon.png" rel="icon" />
    <link href="/assets/img/apple-touch-icon.png" rel="apple-touch-icon" />

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com" rel="preconnect" />
    <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Source+Sans+Pro:ital,wght@0,200;0,300;0,400;0,600;0,700;0,900;1,200;1,300;1,400;1,600;1,700;1,900&display=swap"
      rel="stylesheet"
    />

    <!-- Vendor CSS Files -->
    <link
      href="/assets/vendor/bootstrap/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <link
      href="/assets/vendor/bootstrap-icons/bootstrap-icons.css"
      rel="stylesheet"
    />
    <link href="/assets/vendor/aos/aos.css" rel="stylesheet" />
    <link
      href="/assets/vendor/glightbox/css/glightbox.min.css"
      rel="stylesheet"
    />
    <link href="/assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet" />

    <!-- Main CSS File -->
    <link href="/assets/css/main.css" rel="stylesheet" />

    <!-- Leaflet CSS Library -->
    <!-- <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
      integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
      crossorigin=""
    /> -->
    <link rel="stylesheet" href="../Plugin/libs/leaflet/leaflet.css" />
    <link rel="stylesheet" href="../Plugin/fontawesome 5.15.4/all.css" />

    <link
      rel="stylesheet"
      href="../Plugin/libs/leaflet-search/leaflet-search.src.css"
    />
    <link
      rel="stylesheet"
      href="../Plugin/libs/leaflet-search2/leaflet-search.css"
    />
    <link
      rel="stylesheet"
      href="../Plugin/libs/leaflet-locatecontrol/L.Control.Locate.min.css"
    />

    <link rel="stylesheet" href="../Plugin/libs/leaflet/Control.Geocoder.css" />
    <link
      rel="stylesheet"
      href="../Plugin/libs/leaflet-mouseposition/L.Control.MousePosition.css"
    />
    <link
      rel="stylesheet"
      type="text/css"
      href="https://rawgit.com/MarcChasse/leaflet.ScaleFactor/master/leaflet.scalefactor.min.css"
    />
    <link
      rel="stylesheet"
      href="../Plugin/libs/leaflet-minimap/Control.MiniMap.css"
    />
    <link
      rel="stylesheet"
      href="../Plugin/libs/leaflet-easybutton-master/easy-button.css"
    />
    <link
      rel="stylesheet"
      href="../Plugin/libs/leaflet-layergrup-control/leaflet.groupedlayercontrol.css"
    />
    <style>
      html,
      body,
      #map {
        height: 95%;
      }
      #legenda {
        position: absolute;
        margin-bottom: -5px;
        bottom: 1px;
        left: 0px;
        padding: 10px;
        z-index: 700;
      }
      .scrollable-menu {
        max-height: 200px; /* Sesuaikan dengan tinggi yang diinginkan */
        overflow-y: auto; /* Menambahkan scrollbar vertikal */
      }

      /* Background pada Judul */
      *.info {
        padding: 6px 8px;
        font: 12px/14px Arial, Helvetica, sans-serif;
        background: white;
        background: rgba(255, 255, 255, 0.8);
        box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);
        border-radius: 5px;
        text-align: center;
      }

      .info h4 {
        margin: 0 0 5px;
        color: rgb(0, 0, 0);
        font-weight: 700;
      }
      .leaflet-control-layers-list {
        max-height: 150px;
        overflow-y: auto;
        overflow-x: auto;
      }
      .leaflet-control-layers label {
        display: flex;
        align-items: center;
      }
      .leaflet-control-layers img {
        margin-right: 5px;
      }
    </style>
  </head>
  <body class="blog-details-page">
    <script src="../Plugin/fontawesome 5.15.4/all.js"></script>
    <!-- Leaflet JavaScript Library -->
    <script src="https://unpkg.com/leaflet@ 1.5.1/dist/leaflet.js"></script>

    <!-- leaflet js plugin -->
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="../Plugin/libs/leaflet/leaflet.js"></script>
    <script src="../Plugin/libs/leaflet/leaflet-src.js"></script>
    <script src="../Plugin/libs/leaflet-search/leaflet-search.src.js"></script>
    <script src="../Plugin/libs/leaflet-search2/leaflet-search.js"></script>
    <script src="../Plugin/libs/fuse/fuse.js"></script>
    <script src="../Plugin/libs/leaflet/Control.Geocoder.js"></script>
    <script src="../Plugin/libs/leaflet-locatecontrol/L.Control.Locate.min.js"></script>
    <script src="../Plugin/libs/leaflet-browser-print-master/leaflet.browser.print.js"></script>
    <script src="../Plugin/libs/leaflet-browser-print-master/leaflet.browser.print.utils.js"></script>
    <script src="../Plugin/libs/leaflet-browser-print-master/leaflet.browser.print.sizes.js"></script>
    <script
      src="../Plugin/libs/leaflet-minimap/Control.MiniMap.js"
      type="text/javascript"
    ></script>
    <script src="../Plugin/libs/leaflet-layergrup-control/leaflet.groupedlayercontrol.js"></script>
    <script src="../Plugin/libs/esri-leaflet/esri-leaflet-debug.js"></script>
    <script src="../Plugin/libs/leaflet-easybutton-master/easy-button.js"></script>
    <script src="../Plugin/libs/leaflet-mouseposition/L.Control.MousePosition.js"></script>
    <script src="https://rawgit.com/MarcChasse/leaflet.ScaleFactor/master/leaflet.scalefactor.min.js"></script>
    <script src="../Plugin/js_map/Autolinker.min.js"></script>

    <header id="header" class="header d-flex align-items-center sticky-top">
      <div
        class="container-fluid position-relative d-flex align-items-center justify-content-between"
      >
        <a
          href="index.html"
          class="logo d-flex align-items-center me-auto me-xl-0"
        >
          <!-- Uncomment the line below if you also wish to use an image logo -->
          <!-- <img src="assets/img/logo.png" alt=""> -->
          <h5 class="sitename"><b>DESA GEOCIRCLE</b></h5>
        </a>

        <nav id="navmenu" class="navmenu">
          <ul>
            <li>
              <a href="#hero">Beranda<br /></a>
            </li>
            <li class="dropdown">
              <a href="#"
                ><span>Profil</span>
                <i class="bi bi-chevron-down toggle-dropdown"></i
              ></a>
              <ul>
                <li><a href="#about">Tentang Desa</a></li>
                <li><a href="#about">Visi dan Misi</a></li>
                <li><a href="#team">Struktur</a></li>
                <li><a href="#">Dll</a></li>
              </ul>
            </li>
            <li class="dropdown">
              <a href="#"
                ><span>Info Desa</span>
                <i class="bi bi-chevron-down toggle-dropdown"></i
              ></a>
              <ul>
                <li><a href="#faq">Pengumuman</a></li>
                <li><a href="/blog.html">Berita</a></li>
                <li><a href="#portfolio">Kegiatan</a></li>
                <li><a href="#">Dll</a></li>
              </ul>
            </li>
            <li class="dropdown">
              <a href="#" class="active"
                ><span>Data Desa</span>
                <i class="bi bi-chevron-down toggle-dropdown"></i
              ></a>
              <ul>
                <li class="dropdown">
                  <a href="#"
                    ><span>Statistik</span>
                    <i class="bi bi-chevron-down toggle-dropdown"></i
                  ></a>
                  <ul>
                    <li><a href="#">Teritorial</a></li>
                    <li><a href="#">Kependudukan</a></li>
                    <li><a href="#">dll</a></li>
                  </ul>
                </li>
                <li class="dropdown">
                  <a href="#"
                    ><span>Geospasial</span>
                    <i class="bi bi-chevron-down toggle-dropdown"></i
                  ></a>
                  <ul>
                    <li><a href="#">Peta Fasilitas Umum</a></li>
                    <li><a href="#">Peta Tutupan Lahan</a></li>
                    <li><a href="#">Peta Kependudukan</a></li>
                    <li><a href="#">Peta Dll</a></li>
                  </ul>
                </li>
                <li><a href="#">Keuangan</a></li>
              </ul>
            </li>
            <li class="dropdown">
              <a href="#"
                ><span>Layanan</span>
                <i class="bi bi-chevron-down toggle-dropdown"></i
              ></a>
              <ul>
                <li><a href="#">Surat Online</a></li>
                <li><a href="#">Pengaduan</a></li>
                <li><a href="#">Panduan</a></li>
                <li><a href="#">Dll</a></li>
              </ul>
            </li>
            <li><a href="#contact">Kontak</a></li>
          </ul>
          <i class="mobile-nav-toggle d-xl-none bi bi-list"></i>
        </nav>

        <a class="btn-getstarted" href="index.html"><b>Login</b></a>
      </div>
    </header>

    <main class="main">
      <!-- Page Title -->
      <div class="page-title" data-aos="fade" style="background-color: #effdff">
        <div
          class="container d-lg-flex justify-content-between align-items-center"
        >
          <nav class="breadcrumbs">
            <ol>
              <li><a href="#">Data Desa</a></li>
              <li class="current">Geospasial</li>
            </ol>
          </nav>

          <div class="btn-group">
            <button
              type="button"
              class="btn btn-getstarted btn-sm dropdown-toggle"
              data-bs-toggle="dropdown"
              aria-expanded="false"
              style="font-size: 14px; margin-top: 10px"
            >
              Kategori Peta
            </button>
            <ul class="dropdown-menu" style="font-size: 14px">
              <li><a class="dropdown-item" href="#">Peta 1</a></li>
              <li><a class="dropdown-item" href="#">Peta 2</a></li>
              <li><a class="dropdown-item" href="#">Peta 3</a></li>
            </ul>
          </div>
          <!-- <nav class="nav-item dropdown">
            <a
              class="nav-link dropdown-toggle"
              data-bs-toggle="dropdown"
              href="#"
              role="button"
              aria-expanded="false"
              style="font-size: 14px; margin-top: 10px"
              >Kategori Peta</a
            >
            <ul class="dropdown-menu" style="font-size: 14px">
              <li><a class="dropdown-item" href="#">Peta 1</a></li>
              <li><a class="dropdown-item" href="#">Peta 2</a></li>
              <li><a class="dropdown-item" href="#">Peta 3</a></li>
            </ul>
          </nav> -->
        </div>
      </div>
      <!-- End Page Title -->
    </main>

    <div id="map"></div>
    <script>
      var icons = {
        rumah: L.icon({
          iconUrl: "assets/img/legend/home.png",
          iconSize: [12, 12],
        }),
        sosial: L.icon({
          iconUrl: "assets/img/legend/kantorpemerintah.png",
          iconSize: [22, 22],
        }),
        kantor: L.icon({
          iconUrl: "assets/img/legend/industri.png",
          iconSize: [22, 22],
        }),
        pendidikan: L.icon({
          iconUrl: "assets/img/legend/pendidikan.png",
          iconSize: [22, 22],
        }),
        pdj: L.icon({
          iconUrl: "assets/img/legend/pdj.png",
          iconSize: [22, 22],
        }),
        peribadatan: L.icon({
          iconUrl: "assets/img/legend/masjid.png",
          iconSize: [22, 22],
        }),
        rth: L.icon({
          iconUrl: "assets/img/legend/makam.png",
          iconSize: [22, 22],
        }),
        jalan: L.icon({
          iconUrl: "assets/img/legend/jalanlokal.png",
          iconSize: [22, 22],
        }),
        sungai: L.icon({
          iconUrl: "assets/img/legend/sungai.png",
          iconSize: [22, 22],
        }),
        drainase: L.icon({
          iconUrl: "assets/img/legend/drainase.png",
          iconSize: [22, 22],
        }),
        batasadmin: L.icon({
          iconUrl: "assets/img/legend/batasadmin.png",
          iconSize: [22, 22],
        }),
        batastanahdesa: L.icon({
          iconUrl: "assets/img/legend/batastanahdesa.png",
          iconSize: [22, 22],
        }),
      };
      /* Initial Map */
      var map = L.map("map", {
        zoomControl: false,
        maxZoom: 30,
        minZoom: 1,
      }).setView([-7.5752, 110.68339], 15);
      /* Judul dan Subjudul */
      var title = new L.Control();
      title.onAdd = function (map) {
        this._div = L.DomUtil.create("div", "info");
        this.update();
        return this._div;
      };
      title.update = function () {
        this._div.innerHTML =
          "<h4>WEBGIS DESA KEMASAN</h4>DIBUAT: GEOCIRCLE INDONESIA";
      };
      title.addTo(map);

      var zoomBar = L.easyBar([
        L.easyButton("<big>+</big>", function (control, map) {
          map.setZoom(map.getZoom() + 1);
        }),
        L.easyButton("fa-home fa-lg", function (control, map) {
          map.fitBounds(BatasDukuh.getBounds());
        }),
        L.easyButton("<big>-</big>", function (control, map) {
          map.setZoom(map.getZoom() - 1);
        }),
      ]);
      zoomBar.addTo(map);

      /* Geolocation Plugin  */
      var locateControl = L.control
        .locate({
          position: "topleft",
          drawCircle: true,
          follow: true,
          setView: true,
          keepCurrentZoomLevel: false,
          markerStyle: {
            weight: 1,
            opacity: 0.8,
            fillOpacity: 0.8,
          },
          circleStyle: {
            weight: 1,
            clickable: false,
          },
          icon: "fas fa-map-marker-alt",
          metric: true,
          strings: {
            title: "Cari Lokasimu...",
            popoup: "You're here. Accuracy {distance} {unit}",
            outsideMapBoundsMsg: "Not Available",
          },
          locateOptions: {
            maxZoom: 16,
            watch: true,
            enableHighAccuracy: true,
            maximumAge: 10000,
            timeout: 10000,
          },
        })
        .addTo(map);

      /* Tile Basemap */
      var basemapLayers = {
        //Basemap: OpenStreetMap
        OSM: L.tileLayer("http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
          attribution:
            '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>',
          subdomains: ["a", "b", "c"],
          minZoom: 0,
          maxZoom: 30,
        }),
        //Basemap: GoogleMaps
        "Google Maps": L.tileLayer(
          "https://mt1.google.com/vt/lyrs=s&x={x}&y={y}&z={z}",
          {
            minZoom: 0,
            maxZoom: 30,
          }
        ),
      };

      map.addLayer(basemapLayers.OSM);

      var basemapLayersCopy = {
        //Basemap: OpenStreetMap
        OSM: L.tileLayer("http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
          subdomains: ["a", "b", "c"],
          minZoom: 0,
          maxZoom: 13,
        }),

        //Basemap: GoogleMaps
        GoogleMaps: L.tileLayer(
          "https://mt1.google.com/vt/lyrs=s&x={x}&y={y}&z={z}",
          {
            minZoom: 0,
            maxZoom: 13,
          }
        ),
      };

      $.getJSON("../Data/penduduk.geojson", function (data) {
        rumah.addData(data);
        map.addLayer(rumah);
      });
      // Deklarasi variabel rumah
      var rumah = L.geoJson(null, {
        pointToLayer: function (feature, latlng) {
          var icon = icons.rumah; // Sesuaikan dengan tipe ikon yang diinginkan
          return L.marker(latlng, { icon: icon });
        },
        onEachFeature: function (feature, layer) {
          var content = "Pemilik Rumah : " + feature.properties.Nama_Kepal;

          layer.on({
            click: function (e) {
              layer.bindPopup(content).openPopup();
            },
          });
        },
      });

      $.getJSON("../Data/fasum.geojson", function (data) {
        fasum.addData(data);
      });

      var fasumGroups = {
        sosial: L.featureGroup().addTo(map),
        kantor: L.featureGroup().addTo(map),
        rth: L.featureGroup().addTo(map),
        pendidikan: L.featureGroup().addTo(map),
        pdj: L.featureGroup().addTo(map),
        peribadatan: L.featureGroup().addTo(map),
      };

      var fasum = L.geoJson(null, {
        pointToLayer: function (feature, latlng) {
          var icon;
          if (feature.properties.JENIS === "Fasilitas Sosial") {
            icon = icons.sosial;
          } else if (feature.properties.JENIS === "Perkantoran") {
            icon = icons.kantor;
          } else if (feature.properties.JENIS === "Ruang Terbuka Hijau") {
            icon = icons.rth;
          } else if (feature.properties.JENIS === "Pendidikan") {
            icon = icons.pendidikan;
          } else if (feature.properties.JENIS === "Perdagangan dan Jasa") {
            icon = icons.pdj;
          } else {
            icon = icons.peribadatan;
          }

          return L.marker(latlng, { icon: icon });
        },
        onEachFeature: function (feature, layer) {
          var content =
            "Jenis Fasum : " +
            feature.properties.JENIS +
            "<br>" +
            "Nama Fasum : " +
            feature.properties.TOPONIM +
            "<br>";

          layer.on({
            click: function (e) {
              layer.bindPopup(content);
            },
            mouseover: function (e) {
              layer.bindTooltip(feature.properties.JENIS);
            },
          });

          // Menentukan grup dan menambahkan layer
          if (feature.properties.JENIS === "Fasilitas Sosial") {
            fasumGroups.sosial.addLayer(layer);
          } else if (feature.properties.JENIS === "Perkantoran") {
            fasumGroups.kantor.addLayer(layer);
          } else if (feature.properties.JENIS === "Ruang Terbuka Hijau") {
            fasumGroups.rth.addLayer(layer);
          } else if (feature.properties.JENIS === "Pendidikan") {
            fasumGroups.pendidikan.addLayer(layer);
          } else if (feature.properties.JENIS === "Perdagangan dan Jasa") {
            fasumGroups.pdj.addLayer(layer);
          } else {
            fasumGroups.peribadatan.addLayer(layer);
          }
        },
      });

      /* memanggil data file geojson line */
      $.getJSON("../Data/jalan.geojson", function (data) {
        jalan.addData(data);
        map.addLayer(jalan);
        //map.fitBounds(fasum.getBounds());
      });

      //Menampilkan Data Garis
      var jalan = L.geoJson(null, {
        style: function (feature) {
          if (feature.properties.KETERANGAN == "Jalan") {
            return {
              pane: "pane_jalan",
              opacity: 1,
              color: "red",
              weight: 2.0,
            };
          }
        },

        onEachFeature: function (feature, layer) {
          layer.on({
            click: function (e) {
              //Fungsi ketika icon simbol di-klik
              jalan.bindPopup(content);
            },

            mouseover: function (e) {
              jalan.bindTooltip(feature.properties.KETERANGAN);
            },

            //mouseout: function (e) {
            //fasum.closePopup();
            //},
          });
        },
      });

      // Memuat data GeoJSON
      $.getJSON("../Data/perairan.geojson", function (data) {
        jaringanAir.addData(data);
      });

      // Buat dua feature group untuk sungai dan irigasi
      var sungaiLayer = L.featureGroup().addTo(map);
      var irigasiLayer = L.featureGroup().addTo(map);

      // Pisahkan data jaringan air berdasarkan jenis
      var jaringanAir = L.geoJson(null, {
        style: function (feature) {
          if (feature.properties.JENIS === "Sungai") {
            return {
              color: "#38a9eb",
              weight: 2.0,
              pane: "pane_sungai",
            };
          } else if (feature.properties.JENIS === "Irigasi") {
            return {
              color: "#33efc0",
              weight: 1.0,
              pane: "pane_irigasi",
            };
          }
        },
        onEachFeature: function (feature, layer) {
          layer.on({
            click: function (e) {
              layer.bindPopup(feature.properties.JENIS);
            },
            mouseover: function (e) {
              layer.bindTooltip(feature.properties.JENIS);
            },
          });

          // Menambahkan layer ke feature group yang sesuai
          if (feature.properties.JENIS === "Sungai") {
            sungaiLayer.addLayer(layer);
          } else if (feature.properties.JENIS === "Irigasi") {
            irigasiLayer.addLayer(layer);
          }
        },
      });

      /* memanggil data file geojson area */
      $.getJSON("../Data/tanah_desa.geojson", function (data) {
        TanahDesa.addData(data);
        map.addLayer(TanahDesa);
      });
      //Deklarasi variabel batas admin
      var TanahDesa = L.geoJSON(null, {
        style: function (feature) {
          return {
            pane: "pane_tanahdesa",
            weight: 2.0,
            opacity: 0.5,
            color: "orange",
          };
        },
        onEachFeature: function (feature, layer) {
          var content =
            "NIK: " +
            feature.properties.NIK +
            "<br>" +
            "Alamat OBJP: " +
            feature.properties.ALMAT_OBJP +
            "<br>" +
            "Luas (m2): " +
            feature.properties.LUAS +
            "<br>";

          layer.on({
            click: function (e) {
              //Fungsi ketika obyek di klik}
              TanahDesa.bindPopup(content);
            },
            mouseover: function (e) {
              //Fungsi mouse berada di atas objek untuk highlight
              var TanahDesa = e.target; //variabel layer}
              TanahDesa.setStyle({
                //Highlight style
                color: "red", //Warna garis tepi polygon
                weight: 0.2, //Tebal garis tepi polygon
                opacity: 1, //Transparansi garis tepi polygon
                fillColor: "#62f71b", //Warna tengah polygon
                fillOpacity: 0.4, //Transparansi polygon
              });
              TanahDesa.bindTooltip(feature.properties.NAMA_WP);
            },
            mouseout: function (e) {
              //Fungsi mouse keluar dari obyek
              TanahDesa.resetStyle(e.target); //Mengembalikan style garis ke style awal
              map.closePopup(); //Menutup popup
            },
          });
        },
      });
      /* memanggil data file geojson area */
      $.getJSON("../Data/batas_admin.geojson", function (data) {
        BatasDukuh.addData(data);
        map.addLayer(BatasDukuh);
        //map.fitBounds(fasum.getBounds());
      });
      //Deklarasi variabel batas admin
      var BatasDukuh = L.geoJSON(null, {
        style: function (feature) {
          return {
            pane: "pane_batasdukuh",
            weight: 2.0,
            opacity: 0.5,
            color: "black",
            fillColor: "#b3b9ba",
            dashArray: "10,5,1,5,1,5",
            lineCap: "butt",
            lineJoin: "miter",
          };
        },
        onEachFeature: function (feature, layer) {
          var content =
            "Dukuh: " +
            feature.properties.DUKUH +
            "<br>" +
            "RT: " +
            feature.properties.RT +
            "<br>" +
            "RW: " +
            feature.properties.RW +
            "<br>" +
            "Ketua RT: " +
            feature.properties.KETUA_RT +
            "<br>";

          layer.on({
            click: function (e) {
              //Fungsi ketika obyek di klik}
              BatasDukuh.bindPopup(content);
            },
            mouseover: function (e) {
              //Fungsi mouse berada di atas objek untuk highlight
              var BatasDukuh = e.target; //variabel layer}
              BatasDukuh.setStyle({
                //Highlight style
                color: "grey", //Warna garis tepi polygon
                weight: 0.2, //Tebal garis tepi polygon
                opacity: 1, //Transparansi garis tepi polygon
                fillColor: "#beeff6", //Warna tengah polygon
                fillOpacity: 0.4, //Transparansi polygon
              });
              BatasDukuh.bindTooltip(feature.properties.DUKUH);
            },
            mouseout: function (e) {
              //Fungsi mouse keluar dari obyek
              BatasDukuh.resetStyle(e.target); //Mengembalikan style garis ke style awal
              map.closePopup(); //Menutup popup
            },
          });
        },
      });
      map.createPane("pane_jalan");
      map.getPane("pane_jalan").style.zIndex = 404;
      map.getPane("pane_jalan").style["mix-blend-mode"] = "normal";

      map.createPane("pane_sungai");
      map.getPane("pane_sungai").style.zIndex = 403;
      map.getPane("pane_sungai").style["mix-blend-mode"] = "normal";

      map.createPane("pane_irigasi");
      map.getPane("pane_irigasi").style.zIndex = 402;
      map.getPane("pane_irigasi").style["mix-blend-mode"] = "normal";

      map.createPane("pane_batasdukuh");
      map.getPane("pane_batasdukuh").style.zIndex = 401;
      map.getPane("pane_batasdukuh").style["mix-blend-mode"] = "normal";

      map.createPane("pane_tanahdesa");
      map.getPane("pane_tanahdesa").style.zIndex = 400;
      map.getPane("pane_tanahdesa").style["mix-blend-mode"] = "normal";

      // Fungsi untuk membuat label dengan ikon
      var createLayerLabel = (icon, label) =>
        `<img src="${icon.options.iconUrl}" width="20" height="20"> ${label}`;

      var addGroupedLayerControl = (layers) => {
        var groupedOverlays = {
          Kependudukan: {
            [createLayerLabel(icons.rumah, "Rumah Penduduk")]: layers.rumah,
          },
          "Fasilitas Umum": {
            [createLayerLabel(icons.sosial, "Fasilitas Sosial")]: layers.sosial,
            [createLayerLabel(icons.kantor, "Perkantoran")]: layers.kantor,
            [createLayerLabel(icons.rth, "Ruang Terbuka Hijau")]: layers.rth,
            [createLayerLabel(icons.pendidikan, "Pendidikan")]:
              layers.pendidikan,
            [createLayerLabel(icons.pdj, "Perdagangan dan Jasa")]: layers.pdj,
          },
          "Jaringan Jalan": {
            [createLayerLabel(icons.jalan, "Jalan")]: layers.jalan,
          },
          "Jaringan Air": {
            [createLayerLabel(icons.sungai, "Sungai")]: layers.sungai,
            [createLayerLabel(icons.drainase, "Irigasi")]: layers.irigasi,
          },
          "Tanah Desa": {
            [createLayerLabel(icons.batastanahdesa, "Tanah Desa")]:
              layers.tanahdesa,
          },
          "Batas Dukuh": {
            [createLayerLabel(icons.batasadmin, "Batas Dukuh")]:
              layers.batasdukuh,
          },
        };

        L.control
          .groupedLayers(basemapLayers, groupedOverlays, { collapsed: true })
          .addTo(map);
      };

      var layers = {
        rumah: rumah,
        sosial: fasumGroups.sosial,
        kantor: fasumGroups.kantor,
        rth: fasumGroups.rth,
        pendidikan: fasumGroups.pendidikan,
        pdj: fasumGroups.pdj,
        jalan: jalan,
        sungai: sungaiLayer,
        irigasi: irigasiLayer,
        tanahdesa: TanahDesa,
        batasdukuh: BatasDukuh,
      };

      addGroupedLayerControl(layers);

      /*cari layer*/
      var searchControl = new L.Control.Search({
        position: "topleft",
        textPlaceholder: "Cari Padukuhan...",
        layer: BatasDukuh, //Nama variabel layer
        propertyName: "DUKUH", //Field untuk pencarian
        marker: false,
        moveToLocation: function (latlng, title, map) {
          var zoom = map.getBoundsZoom(latlng.layer.getBounds());
          map.setView(latlng, zoom);
        },
      });
      searchControl
        .on("search:locationfound", function (e) {
          e.layer.setStyle({
            fillColor: "#ffff00",
            color: "#0000ff",
          });
        })
        .on("search:collapsed", function (e) {
          featuresLayer.eachLayer(function (layer) {
            featuresLayer.resetStyle(layer);
          });
        });
      map.addControl(searchControl);

      L.control
        .browserPrint({
          closePopupsOnPrint: false,
          printModes: [
            L.control.browserPrint.mode.landscape("Tabloid", "Tabloid"),
            L.control.browserPrint.mode.landscape(),
            L.control.browserPrint.mode.portrait(),
            L.control.browserPrint.mode.auto("Auto", "A4"),
            L.control.browserPrint.mode.custom("Pilih Area", "A4"),
          ],
        })
        .addTo(map);

      /* Scale Bar */
      L.control
        .scale({
          maxWidth: 150,
          position: "bottomright",
        })
        .addTo(map);
      /* Scale Factor Plugin */
      L.control
        .scalefactor({
          maxWidth: 250,
          position: "bottomright",
        })
        .addTo(map);

      // Coordinate Position Plugin
      L.control
        .mousePosition({
          maxWidth: 150,
          position: "bottomright",
        })
        .addTo(map);

      var rect1 = {
        color: "#ff1100",
        weight: 2,
      };
      var rect2 = {
        color: "#0000AA",
        weight: 1,
        opacity: 0,
        fillOpacity: 0,
      };
      var miniMap = new L.Control.MiniMap(basemapLayersCopy.GoogleMaps, {
        width: 100,
        height: 100,
        toggleDisplay: true,
        aimingRectOptions: rect1,
        shadowRectOptions: rect2,
      }).addTo(map);

      map.on("baselayerchange", function (e) {
        miniMap.changeLayer(basemapLayersCopy[e.name]);
      });
    </script>

    <!-- Scroll Top -->
    <a
      href="#"
      id="scroll-top"
      class="scroll-top d-flex align-items-center justify-content-center"
      ><i class="bi bi-arrow-up-short"></i
    ></a>

    <!-- Preloader -->
    <div id="preloader"></div>

    <!-- Vendor JS Files -->
    <script src="/assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="/assets/vendor/php-email-form/validate.js"></script>
    <script src="/assets/vendor/aos/aos.js"></script>
    <script src="/assets/vendor/glightbox/js/glightbox.min.js"></script>
    <script src="/assets/vendor/swiper/swiper-bundle.min.js"></script>
    <script src="/assets/vendor/imagesloaded/imagesloaded.pkgd.min.js"></script>
    <script src="/assets/vendor/isotope-layout/isotope.pkgd.min.js"></script>

    <!-- Main JS File -->
    <script src="/assets/js/main.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js"></script>
  </body>
</html>
